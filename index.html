<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="index, follow">
  <meta name="googlebot" content="index, follow">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://juunini.github.io/webp-converter-browser">
  <meta property="og:title" content="Online WebP Converter">
  <meta property="og:image" content="https://repository-images.githubusercontent.com/584793683/0db86c0f-83ac-4387-991c-9ab84ba2e60c">
  <meta property="og:description" content="Convert your image to WebP">
  <meta property="og:site_name" content="Online WebP Converter">
  <meta property="og:locale" content="en_US">
  <meta property="og:image:width" content="1204">
  <meta property="og:image:height" content="576">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@juunini">
  <meta name="twitter:creator" content="@juunini">
  <meta name="twitter:title" content="Online WebP Converter">
  <meta name="twitter:description" content="Convert your image to WebP">
  <meta name="twitter:image" content="https://repository-images.githubusercontent.com/584793683/0db86c0f-83ac-4387-991c-9ab84ba2e60c">
  <meta name="twitter:image:alt" content="Online WebP Converter">
  <meta name="description" content="Convert your image to WebP">
  <meta name="keywords" content="webp, converter, image, online, browser">
  <meta name="author" content="juunini">
  <meta name="application-name" content="Online WebP Converter">
  <meta name="theme-color" content="#ffffff">

  <link rel="icon" href="./favicon.ico" type="image/x-icon">
  <script src="https://cdn.jsdelivr.net/npm/webp-converter-browser@latest/dist/index.min.js"></script>
  <title>Online WebP Converter</title>
</head>
<body>
  <h1>
    Online WebP Converter
    <a href="https://github.com/juunini/webp-converter-browser" style="font-size: 0.5em;" target="_new">Link to GitHub</a>
  </h1>

  <label for="given">Image: </label>
  <input type="file" id="given" accept="image/*" />

  <label for="quality">Quality: </label>
  <input type="range" id="quality" min="0" max="100" value="75" />
  <span id="qualityValue">75</span>

  <br />

  <label for="width">Width: </label>
  <input type="number" id="width" min="0" value="" style="width: 50px" />

  <label for="height">Height: </label>
  <input type="number" id="height" min="0" value="" style="width: 50px" />

  <br />

  <button type="button" id="download">Download</button>

  <br /><br />

  <img id="img" src="" alt="" />

  <script>
    given.addEventListener('change', () => {
      const file = given.files[0]

      webpConverterBrowser.blobToWebP(file, { quality: quality.value }).then((blob) => {
        const url = URL.createObjectURL(blob)
        img.src = url

        const image = new Image()
        image.src = url

        image.addEventListener('load', () => {
          width.value = image.width
          height.value = image.height

          img.style.width = `${image.width}px`
          img.style.height = `${image.height}px`
        })
      })
    })

    download.addEventListener('click', () => {
      const file = given.files[0]

      webpConverterBrowser.blobToWebP(file, {
        quality: quality.value,
        width: width.value,
        height: height.value
      }).then((blob) => {
        const url = URL.createObjectURL(blob)
        const a = document.createElement('a')

        a.href = url
        a.download = file.name.split('.').slice(0, -1).join('.') + '-converted.webp'

        a.click()
        a.remove()
      })
    })

    quality.addEventListener('input', () => {
      qualityValue.innerText = quality.value
    })

    width.addEventListener('input', () => {
      img.style.width = `${width.value}px`
    })

    height.addEventListener('input', () => {
      img.style.height = `${height.value}px`
    })
  </script>
</body>
</html>
